#!/bin/bash

STEAM_DIR="$HOME/.steam/steam/steamapps"
OUTPUT=()

# Find all .acf files and process them
while IFS= read -r file; do
    appid=$(grep -m1 '"appid"' "$file" | sed -E 's/.*"appid"[[:space:]]*"([0-9]+)".*/\1/')
    name=$(grep -m1 '"name"' "$file" | sed -E 's/.*"name"[[:space:]]*"([^"]+)".*/\1/')
    appDir=$(grep -m1 '"installdir"' "$file" | sed -E 's/.*"installdir"[[:space:]]*"([^"]+)".*/\1/')

    appPath="$STEAM_DIR/common/$appDir"
    workshopPath="$STEAM_DIR/workshop/content/$appid"

    appPathLink=$(echo -e "\033]8;;$appPath\033\\AppPath\033]8;;\033\\")
    workshopLink=$(echo -e "\033]8;;$workshopPath\033\\Workshop\033]8;;\033\\")

    OUTPUT+=("AppID: $(printf '%-12s' "$appid") Name: $(printf '%-42s' "$name") Path: $appPathLink, $workshopLink")

done < <(find "$STEAM_DIR" -type f -name 'appmanifest_*.acf')

# Sort and print
printf "%s\n" "${OUTPUT[@]}" | sort -k3

