#!/bin/bash

# 1. Define the LED path
LED_FILE="/sys/class/leds/platform::micmute/brightness"

LOGGED_IN_USER=$(logname)

sudo -u "$LOGGED_IN_USER" /usr/bin/pactl set-source-mute @DEFAULT_SOURCE@ toggle

MUTE_STATUS=$(sudo -u "$LOGGED_IN_USER" /usr/bin/pactl get-source-mute @DEFAULT_SOURCE@ | /usr/bin/awk '{print $2}')

if [ "$MUTE_STATUS" == "yes" ]; then
    LED_VALUE=1
else
    LED_VALUE=0
fi

echo "$LED_VALUE" | sudo /usr/bin/tee "$LED_FILE" > /dev/null
#echo "micmute: $MUTE_STATUS | micmute_led: $LED_VALUE" 