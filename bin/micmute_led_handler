#!/bin/bash
# add this to sudoers (with visudo) to allow this script to run without password:
# myUser ALL=(root) NOPASSWD: /bin/micmute_led_handler

LED_FILE="/sys/class/leds/platform::micmute/brightness"
pactl set-source-mute @DEFAULT_SOURCE@ toggle

MUTE_STATUS=$(pactl get-source-mute @DEFAULT_SOURCE@ | awk '{print $2}')

if [ "$MUTE_STATUS" == "yes" ]; then
    LED_VALUE=1
else
    LED_VALUE=0
fi

echo "$LED_VALUE" | sudo tee "$LED_FILE" > /dev/null
echo "micmute_led: $LED_VALUE"